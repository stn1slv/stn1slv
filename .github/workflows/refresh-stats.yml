name: Refresh statistics
on:
  push:
    branches:
      - main
  schedule: ## Schedule the job to run at 12.am on Sunday.
  - cron: '0 0 * * SUN'
  workflow_dispatch:
permissions:
  contents: write
jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Init repo
        run: |
          git config --global user.name 'stn1slv'
          git config --global user.email 'stn1slv@users.noreply.github.com'
          git pull origin main
      - name: Update GitHub Stats
        run: |
            wget -O img/github-stats-dark.svg "https://github-readme-stats.vercel.app/api?username=stn1slv&show_icons=true&hide_border=true&locale=en&count_private=true&include_all_commits=true&hide_title=true&theme=gotham"
            wget -O img/github-stats-light.svg "https://github-readme-stats.vercel.app/api?username=stn1slv&show_icons=true&hide_border=true&locale=en&count_private=true&include_all_commits=true&hide_title=true&theme=vue"
            wget -O img/github-stats.svg "https://github-readme-stats.vercel.app/api?username=stn1slv&show_icons=true"
      - name: Update GitHub Streak Stats
        run: |
            wget -O img/streak-stats-dark.svg "https://streak-stats.demolab.com/?user=stn1slv&theme=gotham&mode=weekly&card_width=400&hide_border=true"
            wget -O img/streak-stats-light.svg "https://streak-stats.demolab.com/?user=stn1slv&theme=vue&mode=weekly&card_width=400&hide_border=true"
            wget -O img/streak-stats.svg "https://streak-stats.demolab.com/?user=stn1slv&mode=weekly&card_width=400"
      - name: Update Most used languages
        run: |
                wget -O img/top-langs-dark.svg "https://github-readme-stats.vercel.app/api/top-langs?username=stn1slv&show_icons=true&locale=en&layout=compact&hide=markdown,xml&langs_count=8&no-bg=true&hide_border=true&theme=gotham"
                wget -O img/top-langs-light.svg "https://github-readme-stats.vercel.app/api/top-langs?username=stn1slv&show_icons=true&locale=en&layout=compact&hide=markdown,xml&langs_count=8&no-bg=true&theme=vue"
                wget -O img/top-langs.svg "https://github-readme-stats.vercel.app/api/top-langs?username=stn1slv&show_icons=true&locale=en&layout=compact&hide=markdown,xml&langs_count=8&no-bg=true"
      - name: Commit report
        run: |
          git status
          git add *.svg
          git commit -am "Stats refreshed"
          git push origin main
